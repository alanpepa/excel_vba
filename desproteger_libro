Sub desproteger_libro_metodo1()

'Por: Álvaro Andrés Peralta Parra.
'Finalidad: Desproteger libro de Excel, este es el método 1.

If MsgBox("¿Realmente desea desproteger el libro actual?", vbCritical + vbYesNo + vbDefaultButton2, "desproteger_libro_metodo1") = vbYes Then

	Dim i As Integer, j As Integer, k As Integer
	Dim l As Integer, m As Integer, n As Integer

	On Error Resume Next

	For i = 65 To 66: For j = 65 To 66: For k = 65 To 66

	For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66

	For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66

	For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126

		ActiveWorkbook.Unprotect Chr(i) & Chr(j) & Chr(k) & Chr(l) & Chr(m) & Chr(i1) & Chr(i2) & Chr(i3) & Chr(i4) & Chr(i5) & Chr(i6) & Chr(n)

		If ActiveWorkbook.ProtectStructure = False And ActiveWorkbook.ProtectWindows = False Then

			MsgBox "El libro está ahora desprotegido", vbInformation + vbOKOnly, "desproteger_libro_metodo1"

			Exit Sub

		End If

	Next: Next: Next: Next: Next: Next

	Next: Next: Next: Next: Next: Next

End If

End Sub
